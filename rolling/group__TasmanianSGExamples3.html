<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Toolkit for Adaptive Stochastic Modeling and Non-Intrusive ApproximatioN: Tasmanian v7.5: Tasmanian Sparse Grids module, example 3</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="tasmanian.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
    <div class="doxygen">
            <a href="http://www.doxygen.org/index.html">
                <img class="footer" src="doxygen.png" alt="doxygen"/>
                </a> 1.8.13
    </div>
   <div id="projectname">Toolkit for Adaptive Stochastic Modeling and Non-Intrusive ApproximatioN: Tasmanian v7.5
           <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__TasmanianSGExamples3.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Tasmanian Sparse Grids module, example 3<div class="ingroups"><a class="el" href="group__TasmanianSGExamples.html">Examples for the Tasmanian Sparse Grid module</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Tasmanian Sparse Grids module, example 3:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__TasmanianSGExamples3.png" border="0" alt="" usemap="#group____TasmanianSGExamples3"/>
<map name="group____TasmanianSGExamples3" id="group____TasmanianSGExamples3">
<area shape="rect" id="node1" href="group__TasmanianSGExamples.html" title="Examples for the Tasmanian\l Sparse Grid module" alt="" coords="5,5,212,47"/>
</map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaa6f73fa102464e69ea82ac5d59253e56"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TasmanianSGExamples3.html#gaa6f73fa102464e69ea82ac5d59253e56">sparse_grids_example_03</a> ()</td></tr>
<tr class="memdesc:gaa6f73fa102464e69ea82ac5d59253e56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sparse Grids Example 3: compare different quadrature rules.  <a href="#gaa6f73fa102464e69ea82ac5d59253e56">More...</a><br /></td></tr>
<tr class="separator:gaa6f73fa102464e69ea82ac5d59253e56"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<dl class="section user"><dt>Example 3</dt><dd>Compute <img class="formulaInl" alt="$ \int_{-5}^{+5} \int_{-5}^{+5} \int_{-2}^{+3} \int_{-2}^{+3} \exp(-x_1^2 -x_2^2) \cos(x_3) \cos(x_4) dx_4 dx_3 dx_2 dx_1 $" src="form_51.png"/> using different rules and precision. </dd></dl>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaa6f73fa102464e69ea82ac5d59253e56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa6f73fa102464e69ea82ac5d59253e56">&#9670;&nbsp;</a></span>sparse_grids_example_03()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sparse_grids_example_03 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sparse Grids Example 3: compare different quadrature rules. </p>
<p>The example considers a 4D function that is well approximated in a total degree polynomial space. In one and two dimensions, the Gauss-Legendre rule with tensor type gives creates an approximation with the largest total degree space per number of points. In higher dimensions (4 in this case), the sparse (level and qptotal) types have an advantage but the sparse grid construction suffers because the rule is non-nested. The nested Clenshaw-Curtis rule generates about the same total degree space per number of points, but unlike the non-nested rule the extra points are not wasted and hence the approximation is better. The Gauss-Patterson rule, which combines the higher exactness with forced nested structure, outperforms all other methods in precision per number of points.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;\n---------------------------------------------------------------------------------------------------\n&quot;</span>;</div><div class="line">    cout &lt;&lt; std::scientific; cout.precision(2);</div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Example 3: integrate exp(-x1^2 - x2^2) * cos(x3) * cos(x4)\n&quot;</span></div><div class="line">         &lt;&lt; <span class="stringliteral">&quot;           for x1, x2 in [-5,5]; x3, x4 in [-2,3];\n&quot;</span></div><div class="line">         &lt;&lt; <span class="stringliteral">&quot;           using different rules and total degree polynomial space\n\n&quot;</span>;</div><div class="line"></div><div class="line">    <span class="keywordtype">int</span> dimensions = 4;</div><div class="line">    <span class="keywordtype">double</span> exact = 1.861816427518323e+00 * 1.861816427518323e+00; <span class="comment">// exact solution</span></div><div class="line"></div><div class="line">    <span class="comment">// creates a grid over the desired domain with specified precision and rule</span></div><div class="line">    <span class="keyword">auto</span> make_grid = [&amp;](<span class="keywordtype">int</span> precision, <a class="code" href="group__SGEnumerates.html#ga145e27d5ae92acdd5f74149c6d4f2ca2">TasGrid::TypeOneDRule</a> rule)-&gt;</div><div class="line">        <a class="code" href="classTasGrid_1_1TasmanianSparseGrid.html">TasGrid::TasmanianSparseGrid</a>{</div><div class="line">            <span class="keyword">auto</span> grid = <a class="code" href="group__TasmanianSG.html#ga734013b4f52c4d1d9a35d674b459e13a">TasGrid::makeGlobalGrid</a>(dimensions, 0, precision,</div><div class="line">                                                <a class="code" href="group__SGEnumerates.html#gga94134756077eff395566c64e6426455fa383f228695e32d25b6b4d298b5ee55c8">TasGrid::type_qptotal</a>, rule);</div><div class="line">            grid.<a class="code" href="classTasGrid_1_1TasmanianSparseGrid.html#ad05292623b53a824962fe1edb716704f">setDomainTransform</a>({-5.0, -5.0, -2.0, -2.0}, {5.0, 5.0, 3.0, 3.0});</div><div class="line">            <span class="keywordflow">return</span> grid;</div><div class="line">        };</div><div class="line"></div><div class="line">    <span class="comment">// computes the integral using the quadrature provided by the grid</span></div><div class="line">    <span class="comment">// then prints the number of points and the error</span></div><div class="line">    <span class="keyword">auto</span> print_error = [&amp;](<a class="code" href="classTasGrid_1_1TasmanianSparseGrid.html">TasGrid::TasmanianSparseGrid</a> <span class="keyword">const</span> &amp;grid)-&gt;</div><div class="line">        <span class="keywordtype">void</span>{</div><div class="line">            <span class="keyword">auto</span> points = grid.<a class="code" href="classTasGrid_1_1TasmanianSparseGrid.html#a9a7e1d1cdc0f30b3596330e854eea66a">getPoints</a>();</div><div class="line">            <span class="keyword">auto</span> weights = grid.<a class="code" href="classTasGrid_1_1TasmanianSparseGrid.html#afce89f5a45b16377372c0ece15cdcac8">getQuadratureWeights</a>();</div><div class="line">            <span class="keywordtype">double</span> integral = 0.0;</div><div class="line">            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0; i&lt;weights.size(); i++){</div><div class="line">                <span class="keywordtype">double</span> x1 = points[4*i + 0];</div><div class="line">                <span class="keywordtype">double</span> x2 = points[4*i + 1];</div><div class="line">                <span class="keywordtype">double</span> x3 = points[4*i + 2];</div><div class="line">                <span class="keywordtype">double</span> x4 = points[4*i + 3];</div><div class="line">                integral += weights[i] * std::exp(-x1*x1 - x2*x2) * std::cos(x3) * std::cos(x4);</div><div class="line">            }</div><div class="line">            cout &lt;&lt; setw(10) &lt;&lt; grid.<a class="code" href="classTasGrid_1_1TasmanianSparseGrid.html#a09a99fb1f72eb914a37dc92278e0c133">getNumPoints</a>() &lt;&lt; setw(10) &lt;&lt; std::abs(integral - exact);</div><div class="line">        };</div><div class="line"></div><div class="line">    cout &lt;&lt; setw(10) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; setw(20) &lt;&lt; <span class="stringliteral">&quot;Clenshaw-Curtis&quot;</span></div><div class="line">         &lt;&lt; setw(20) &lt;&lt; <span class="stringliteral">&quot;Gauss-Legendre&quot;</span> &lt;&lt; setw(20) &lt;&lt; <span class="stringliteral">&quot;Gauss-Patterson\n&quot;</span>;</div><div class="line">    cout &lt;&lt; setw(10) &lt;&lt; <span class="stringliteral">&quot;precision&quot;</span> &lt;&lt; setw(10) &lt;&lt; <span class="stringliteral">&quot;points&quot;</span> &lt;&lt; setw(10) &lt;&lt; <span class="stringliteral">&quot;error&quot;</span></div><div class="line">         &lt;&lt; setw(10) &lt;&lt; <span class="stringliteral">&quot;points&quot;</span> &lt;&lt; setw(10) &lt;&lt; <span class="stringliteral">&quot;error&quot;</span></div><div class="line">         &lt;&lt; setw(10) &lt;&lt; <span class="stringliteral">&quot;points&quot;</span> &lt;&lt; setw(10) &lt;&lt; <span class="stringliteral">&quot;error\n&quot;</span>;</div><div class="line"></div><div class="line">    <span class="comment">// print the error for different precision</span></div><div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> precision=5; precision&lt;=40; precision += 5){</div><div class="line">        cout &lt;&lt; setw(10) &lt;&lt; precision;</div><div class="line">        print_error( make_grid(precision, <a class="code" href="group__SGEnumerates.html#gga145e27d5ae92acdd5f74149c6d4f2ca2a7979fed9357e95bf01dc3169051f9fcf">TasGrid::rule_clenshawcurtis</a>) );</div><div class="line">        print_error( make_grid(precision, <a class="code" href="group__SGEnumerates.html#gga145e27d5ae92acdd5f74149c6d4f2ca2a40ba886acb7924987021756e388864b6">TasGrid::rule_gausslegendreodd</a>) );</div><div class="line">        print_error( make_grid(precision, <a class="code" href="group__SGEnumerates.html#gga145e27d5ae92acdd5f74149c6d4f2ca2ae0ddcd23738e332619bc84102647c14c">TasGrid::rule_gausspatterson</a>) );</div><div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;\nAt 311K points the Gauss-Legendre error is O(1.E-1),\n&quot;</span></div><div class="line">         &lt;&lt;   <span class="stringliteral">&quot;                   Clenshaw-Curtis error is O(1.E-7) at 320K points.\n&quot;</span>;</div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;At 70K points the Gauss-Patterson error is O(1.E-4),\n&quot;</span></div><div class="line">         &lt;&lt; <span class="stringliteral">&quot;                  Clenshaw-Curtis needs 158K points to achieve the same.&quot;</span> &lt;&lt; endl;</div><div class="line"></div><div class="line"><span class="preprocessor">#ifndef __TASMANIAN_DOXYGEN_SKIP</span></div></div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<!-- <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
<!--  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div> -->
</body>
</html>
